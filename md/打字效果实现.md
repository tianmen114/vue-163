# Vue3 博客首页打字机效果实现教程

在博客首页加一个 **打字机效果（Typing Effect）** 可以让页面更有动态感。下面介绍两种实现方式：

---

## 方法一：使用第三方库 `typed.js`（推荐）

### 1. 安装
在项目根目录执行：
```bash
npm install typed.js
```

### 2. 新建一个组件

```vue
<template>
  <h1 ref="typing"></h1>
</template>

<script setup>
import { ref, onMounted, onBeforeUnmount } from "vue";
import Typed from "typed.js";

const typing = ref(null); // 绑定 h1 标签
let typed = null;         // 保存 typed.js 实例

onMounted(() => {
  typed = new Typed(typing.value, {
    strings: ["欢迎来到我的博客 ✨", "记录学习与生活 💻", "天门的个人空间 🌸"],
    typeSpeed: 80,     // 打字速度
    backSpeed: 50,     // 删除速度
    backDelay: 1500,   // 停顿时间
    loop: true         // 是否循环
  });
});

onBeforeUnmount(() => {
  if (typed) {
    typed.destroy(); // 销毁实例，避免内存泄漏
  }
});
</script>
```

### 3. 更多配置选项

`typed.js` 提供了丰富的配置选项，可以根据需要进行自定义：

- `startDelay`: 延迟开始打字（毫秒）
- `smartBackspace`: 智能退格，只删除不匹配的部分
- `shuffle`: 随机打乱字符串数组
- `fadeOut`: 打字完成后淡出效果
- `contentType`: 内容类型，可以是 'html' 或 'text'

示例：
```javascript
const options = {
  strings: ["欢迎来到我的博客 ✨", "记录学习与生活 💻", "天门的个人空间 🌸"],
  typeSpeed: 80,
  backSpeed: 50,
  backDelay: 1500,
  loop: true,
  startDelay: 1000,      // 延迟1秒开始
  smartBackspace: true,  // 智能退格
  shuffle: false,        // 不随机打乱
  fadeOut: false,        // 不淡出
  contentType: 'html'    // 内容类型
};
```

### 代码解释

1. `ref("typing")`：创建一个响应式引用，用于绑定DOM元素
2. `onMounted`：在组件挂载后初始化typed.js实例
3. `Typed`构造函数参数：
   - 第一个参数是要绑定的DOM元素
   - 第二个参数是配置对象，包含：
     - `strings`：要循环显示的文本数组
     - `typeSpeed`：打字速度（毫秒/字符）
     - `backSpeed`：删除速度（毫秒/字符）
     - `backDelay`：删除前的停顿时间（毫秒）
     - `loop`：是否循环播放
4. `onBeforeUnmount`：在组件卸载前销毁typed.js实例，防止内存泄漏

### 错误处理

在使用 `typed.js` 时，需要注意以下几点：

1. 确保在组件卸载前销毁实例，防止内存泄漏。
2. 如果从网络加载字符串，需要处理网络错误。
3. 确保 DOM 元素在初始化时已经存在。

### 可访问性

为了使打字效果对屏幕阅读器友好，可以考虑以下几点：

1. 为包含打字效果的元素添加 `aria-label` 属性，提供静态文本描述。
2. 使用 `aria-live` 属性来通知屏幕阅读器内容的动态变化。

### SEO

为了确保打字效果中的文本对搜索引擎可见，可以考虑以下几点：

1. 在 HTML 中直接包含文本内容，然后使用 JavaScript 来实现打字效果。
2. 使用 `<noscript>` 标签为不支持 JavaScript 的用户提供替代内容。

---

## 方法二：纯 Vue3 实现（不用库）

### 1. 新建 Typing.vue

```vue
<template>
  <h1>{{ displayText }}<span class="cursor">|</span></h1>
</template>

<script setup>
import { ref, onMounted, onBeforeUnmount } from "vue";

const texts = ["欢迎来到我的博客 ✨", "记录学习与生活 💻", "天门的个人空间 🌸"];
const displayText = ref("");
let index = 0;         // 当前是第几句
let charIndex = 0;     // 当前打到第几个字
let isDeleting = false;
let animationFrameId = null; // 用于存储 requestAnimationFrame 的 ID

function type() {
  const current = texts[index];
  
  if (!isDeleting && charIndex < current.length) {
    // 正在打字
    displayText.value = current.substring(0, charIndex + 1);
    charIndex++;
    animationFrameId = requestAnimationFrame(type);
  } else if (isDeleting && charIndex > 0) {
    // 正在删除
    displayText.value = current.substring(0, charIndex - 1);
    charIndex--;
    animationFrameId = requestAnimationFrame(type);
  } else {
    // 打完或删完
    if (!isDeleting) {
      isDeleting = true;
      setTimeout(() => {
        animationFrameId = requestAnimationFrame(type);
      }, 1000); // 停顿再删
    } else {
      isDeleting = false;
      index = (index + 1) % texts.length;
      setTimeout(() => {
        animationFrameId = requestAnimationFrame(type);
      }, 200);
    }
  }
}

onMounted(() => {
  animationFrameId = requestAnimationFrame(type);
});

onBeforeUnmount(() => {
  if (animationFrameId) {
    cancelAnimationFrame(animationFrameId);
  }
});
</script>

<style>
.cursor {
  display: inline-block;
  margin-left: 2px;
  width: 1ch;
  animation: blink 1s infinite;
}

@keyframes blink {
  0%, 50% { opacity: 1; }
  50%, 100% { opacity: 0; }
}
</style>
```

### 2. 性能优化

在纯 Vue 实现中，我们使用了 `requestAnimationFrame` 来替代 `setTimeout`，以获得更流畅的动画效果。`requestAnimationFrame` 会在浏览器下一次重绘之前执行回调函数，这样可以确保动画与浏览器的刷新率同步，避免掉帧。

我们还添加了在组件卸载前取消动画帧的逻辑，以防止内存泄漏。

### 代码解释

1. `texts`：定义要循环显示的文本数组
2. `displayText`：响应式变量，用于存储当前显示的文本
3. `index`：当前显示的文本在数组中的索引
4. `charIndex`：当前显示到文本中的第几个字符
5. `isDeleting`：标识当前是打字状态还是删除状态
6. `type()`函数：核心逻辑函数，控制打字和删除过程
   - 判断当前状态（打字/删除）
   - 根据状态更新displayText的值
   - 使用`requestAnimationFrame`递归调用实现动画效果
7. `onMounted`：组件挂载后开始执行打字效果
8. `onBeforeUnmount`：组件卸载前取消动画帧，防止内存泄漏
9. CSS部分：
   - `.cursor`：为光标添加样式
   - `@keyframes blink`：定义光标的闪烁动画

### 错误处理

在纯 Vue 实现中，需要注意以下几点：

1. 确保在组件卸载前取消动画帧，防止内存泄漏。
2. 处理数组越界的情况，例如当 `texts` 数组为空时。

### 可访问性

为了使打字效果对屏幕阅读器友好，可以考虑以下几点：

1. 为包含打字效果的元素添加 `aria-label` 属性，提供静态文本描述。
2. 使用 `aria-live` 属性来通知屏幕阅读器内容的动态变化。

### SEO

为了确保打字效果中的文本对搜索引擎可见，可以考虑以下几点：

1. 在 HTML 中直接包含文本内容，然后使用 JavaScript 来实现打字效果。
2. 使用 `<noscript>` 标签为不支持 JavaScript 的用户提供替代内容。

---

## 两种方法对比

| 特性 | typed.js | 纯Vue实现 |
|------|----------|-----------|
| 代码量 | 少 | 多 |
| 功能 | 丰富 | 基础 |
| 依赖 | 需要安装 | 无依赖 |
| 自定义性 | 高 | 中等 |
| 性能 | 较好 | 良好 |

## 总结

两种方法都可以实现打字机效果，如果项目中需要多种动画效果，推荐使用typed.js库；如果只是简单的打字效果，纯Vue实现更轻量。根据项目需求选择合适的方法即可。
